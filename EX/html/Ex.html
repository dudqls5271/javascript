<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>

<head>
  <title> 동적으로 행 삽입하기 스크립트 </title>
  <script language="javascript">
    // 입력폼추가하기
    function addField() {

      var addPlace = document.all.insertPlace; // 추가될테이블장소(2열)
      var addRow = addPlace.insertRow();   // 행
      addRow.onmouseover = function () { addPlace.clickedRowIndex = this.rowIndex; }
      var addCol1 = addRow.insertCell();   // 열
      var addCol2 = addRow.insertCell();   // 열
      addCol1.innerHTML = "<input type='checkbox' name='is_use'><input type='text' name='testing'>";
      addCol2.innerHTML = "<input type='button' value='삭제' onclick='delOneField();'>";
    }

    // 입력폼삭제하기 _ 한행씩
    function delOneField() {

      var delPlace = document.all.insertPlace; // 삭제될테이블장소(2열)

      if (document.all.testing.length > 1) {
        // delPlace.deleteRow();      // 참고 : 위에서부터 지움
        delPlace.deleteRow(delPlace.clickedRowIndex); // 해당인덱스번호부터 지움
      } else {
        alert("마지막 행은 삭제할 수 없습니다.!");
      }
    }

    // 입력폼삭제하기 _ 체크박스체크한행모두
    function delCheckField() {

      var delPlace = document.all.insertPlace; // 삭제될테이블장소(2열)
      var isUse = document.all.is_use;   // 체크박스

      for (var i = 0; i < isUse.length; i++) {
        if (isUse[i].checked) {
          if (isUse.length > 1) {
            delPlace.deleteRow(i);   // 체크된행삭제
            i--;       // 전체적으로 isUse배열이 감소되기때문
          } else {
            alert("마지막 행은 삭제할 수 없습니다.!");
            isUse[i].checked = false;
          }
        }
      }
    }
//-->
  </script>
</head>

<body>
  <table width="100" border="1" cellspacing="0" cellpadding="0">
    <tr>
      <td align="right"><input type="button" value="추가" onclick="addField();"></td>
      <td align="right"><input type="button" value="삭제" onclick="delCheckField();"></td>
    </tr>
    <tr>
      <td>
        <table id="insertPlace">
          <tr onMouseover="document.all.insertPlace.clickedRowIndex=this.rowIndex">
            <td><input type="checkbox" name="is_use"><input type="text" name="testing" value=""></td>
            <td><input type="button" value="삭제" onclick="delOneField();"></td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>

</html>